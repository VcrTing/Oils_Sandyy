"use strict";(self["webpackChunkoils"]=self["webpackChunkoils"]||[]).push([[6099],{800:function(t,e,n){n.d(e,{Z:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div")},r=[],i={name:"",data(){return{}},methods:{async fecthingUser(t){let e=await this.conn.get(this.api.users,this.$store.state.token,{member_code:t});if(e)return e=e?e[0]:{},e}}},a=i,o=n(1001),l=(0,o.Z)(a,s,r,!1,null,"ed9069a8",null),u=l.exports},7416:function(t,e,n){n.d(e,{Z:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"alert alert-warning pa-3 px-7"},[e("span",[t._t("default")],2)])},r=[],i={name:"",data(){return{}}},a=i,o=n(1001),l=(0,o.Z)(a,s,r,!1,null,"8bc171c4",null),u=l.exports},5993:function(t,e,n){n.d(e,{Z:function(){return u}});n(7658);var s=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"px-0",attrs:{fluid:""}},[e("div",{staticClass:"fx-l py-3 pl-5 txt-header"},[e("div",{staticClass:"d-ib hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",{staticClass:"qiong-txt-22"},[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"pl-2 fw-b hand",on:{click:function(e){return t.$emit("back_Father")}}},[t._v(" "+t._s(t.header)+" ")])]),e("div",{staticClass:"panel-pure txt-def"},[t.no_switch?t._e():e("div",{staticClass:"fx-s"},[e("div"),e("div",{staticClass:"qiong-txt-10 changer"},t._l(t.tabs,(function(n,s){return e("button",{key:s,staticClass:"ml-5 hand",class:{"btn-pri-thin py-2 px-6 fw-b":t.now==n.path,"txt-pri":t.now!=n.path},on:{click:function(e){return t.$router.push(n.path)}}},[t._v(" "+t._s(n.txt)+" ")])})),0)]),e("div",{staticClass:"qiong-txt-12 upper"},[t._t("default")],2)]),e("div",{staticClass:"pti-go-top hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"mobie-for-form"})])},r=[],i={name:"",props:["header","no_switch"],data(){return{}},computed:{now(){let t=this.$route.path;return t=t?t.split("/"):null,t=t?t[t.length-1]:null,t},tabs(){return[{txt:"增加 LP 積分",path:"form_lp_plus"},{txt:"更改會員 LP 等級",path:"form_level_change"},{txt:"重啟會員 LP 資格",path:"form_reload_qualify"}]}}},a=i,o=n(1001),l=(0,o.Z)(a,s,r,!1,null,"7b50eaad",null),u=l.exports},6099:function(t,e,n){n.r(e),n.d(e,{default:function(){return Z}});n(7658);var s=function(){var t=this,e=t._self._c;return e("mc-form-page-layout",{attrs:{header:"重啟會員 LP 等級"},on:{back_Father:function(e){return t.$router.push("/home/member_operate/reload_qualify")}}},[e("div",[e("f-mrq-form",{ref:"formREF"})],1),e("div",{staticClass:"btn-transfer an_upper qiong-pt-15 qiong-txt-14"},[e("button",{staticClass:"reset",on:{click:t.reset}},[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-refresh")]),t._v(" 重置表單 ")],1),e("button",{staticClass:"btn-pri",on:{click:t.submit}},[e("v-icon",{staticClass:"qiong-txt-16 mr-3"},[t._v("mdi-check-underline")]),t._v(" 提交結果 ")],1)])])},r=[],i=n(5993),a=function(){var t=this,e=t._self._c;return e("form",{staticClass:"form-def"},[e("v-row",[e("v-col",{attrs:{col:"12",sm:5}},[e("label",[t._v("用戶編號")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.member_code,expression:"funnel.member_code"}],attrs:{type:"text",placeholder:"請輸入用戶的編號"},domProps:{value:t.funnel.member_code},on:{change:t.fetchingUser,input:function(e){e.target.composing||t.$set(t.funnel,"member_code",e.target.value)}}})]),e("v-col",{attrs:{cols:"12",sm:7}},[e("label",[t._v("用戶名稱")]),e("div",{staticClass:"fx-l input input-fix fx-l"},[t.user_loading?e("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[t._v("mdi-loading")]):e("p",[t.user?e("span",[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-account-circle-outline")]),e("span",[t._v(t._s(t.user.display_name))])],1):e("span",[t._v("(自動檢索)")])])],1)])],1),e("v-row",[e("v-col",{attrs:{cols:"8",sm:12}},[e("label",{staticClass:"sub"},[t._v("選擇月份")]),e("nav",{staticClass:"input-timed_tool"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.funnel.year,expression:"funnel.year"}],staticClass:"input",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.funnel,"year",e.target.multiple?n:n[0])}}},t._l(t.geneYear(),(function(n,s){return e("option",{key:s,domProps:{value:n}},[t._v(t._s(n)+"  年")])})),0),e("span",{staticClass:"mx-2 fw-b"}),e("select",{directives:[{name:"model",rawName:"v-model",value:t.funnel.month,expression:"funnel.month"}],staticClass:"input",on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.funnel,"month",e.target.multiple?n:n[0])},function(e){return t.getNowChronu()}]}},t._l(t.mons,(function(n,s){return e("option",{key:s,domProps:{value:n.v}},[t._v(t._s(n.v)+"  月份")])})),0),e("span",{staticClass:"mx-2 fw-b"})])])],1),e("v-row",[e("v-col",{attrs:{col:"12",sm:4}},[e("label",{staticClass:"txt-pri"},[t._v("重啟會員等級")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.funnel.is_reboot,expression:"funnel.is_reboot"}],class:{"option-succ":t.funnel.is_reboot,"option-err":!t.funnel.is_reboot},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.funnel,"is_reboot",e.target.multiple?n:n[0])}}},[e("option",{domProps:{value:!0}},[t._v("重啟")]),e("option",{domProps:{value:!1}},[t._v("移除")])])])],1),e("v-row",[e("v-col",{attrs:{col:"12"}},[e("label",[t._v("備註")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.mark,expression:"funnel.mark"}],staticClass:"input-bg",attrs:{type:"text",placeholder:"輸入您要備註的文字"},domProps:{value:t.funnel.mark},on:{change:t.validMark,input:function(e){e.target.composing||t.$set(t.funnel,"mark",e.target.value)}}})])],1),e("widget-user-by-member-code",{ref:"userREF"}),e("net-chronus",{ref:"chroREF"}),t.msg?e("div",{staticClass:"pt-3 qiong-txt-16 anime-later"},[e("qiong-space",{attrs:{space:"0.5vw"}}),e("dialog-alert",[t._v(t._s(t.msg))])],1):t._e()],1)},o=[],l=n(800),u=n(4711),c=n(934),m=n(7416),h=function(){var t=this,e=t._self._c;return e("div")},d=[],p=n(6797),_=n.n(p),f={methods:{async lunching(){let t=await this.conn.get(this.api.chronus,this.$store.state.token,{_limit:999});return t?t.map((t=>this.ser_res(t))):[]},ser_res(t){return delete t.orders,delete t.bonuses,delete t.bonus_calculations,t.now=_()(t.end).format("yyyy-MM-DD"),t.now_list=t.now.split("-"),t}}},v=f,g=n(1001),b=(0,g.Z)(v,h,d,!1,null,null,null),w=b.exports,y={components:{DateSelect:u.Z,WidgetUserByMemberCode:l.Z,DialogAlert:m.Z,QiongSpace:c.Z,NetChronus:w},computed:{mons(){const t=[],e=this.chronus;return e&&e.map((e=>{e.now_list[0]==this.funnel.year&&t.push({chronu_id:e.id,v:Number.parseInt(e.now_list[1])})})),t},bonus_now(){let t=null,e=this.user;return e&&this.chronu_now&&(e=e.bonuses?e.bonuses:[],e.map((e=>{e.time_period==this.chronu_now.id&&(t=e)}))),t}},data(){return{user:null,user_loading:!1,msg:"",now_y:"",chronus:[],chronu_now:null,funnel:{date:"",mark:"",is_reboot:!0,year:0,month:1,member_code:""},loading:!0}},async mounted(){this.now_y=(new Date).getFullYear(),this.funnel.year=this.now_y,this.reset(),this.chronus=await this.$refs.chroREF.lunching()},methods:{geneYear(t=2021){const e=this.now_y;let n=[t];for(let s=0;s<=e-t;s++)n.push(t+=1);return n},getNowChronu(){const t=this.funnel.month;let e=this.chronus;e&&e.map((e=>{t==Number.parseInt(e.now_list[1])&&(this.chronu_now=e)}))},reciveDate(t){const e=this.view.getToday();let n=this.view.judge_date(t,e);this.funnel.date=n?t:e,n||(this.loading=!0,setTimeout((t=>{this.loading=!1}),600))},validMark(){},validMonth(){const t=this.funnel.month;return!!(t&&t>0)},validCode(){let t=this.funnel.member_code;return t=Number.parseInt(t),t=!!(t&&t>=203e3),t},validNum(){let t=this.funnel.num;return t=Number.parseInt(t),t=!(!t||0==t),t},async fetchingUser(){if(this.validCode()){this.user_loading=!0;let t=await this.$refs.userREF.fecthingUser(this.funnel.member_code);t&&this.setUser(t)}else this.setUser(null)},setUser(t){this.user_loading=!0,this.user=t,setTimeout((t=>this.user_loading=!1),400)},submit(){if(this.validCode()){if(this.validMonth())return this.funnel;this.msg="檢測到您未選擇 月份。"}else this.msg="檢測到 用戶編號 為空或輸入有誤，請檢查輸入。";setTimeout((t=>this.msg=""),4400)},reset(){new Date;this.loading=!0,this.setUser(null),this.funnel={date:this.view.getToday(),mark:"",member_code:"",is_reboot:!0,year:this.now_y,month:this.mons?this.mons[0]:-1},setTimeout((t=>{this.loading=!1}),400)}}},x=y,C=(0,g.Z)(x,a,o,!1,null,null,null),k=C.exports,$={components:{McFormPageLayout:i.Z,FMrqForm:k},name:"",data(){return{}},methods:{reset(){this.$refs.formREF.reset()},async submit(){let t=this.$refs.formREF.submit();if(t){let e=this.api.admin_wallet_lp_reboot(t.member_code);const n=!t.is_reboot;n&&(e=this.api.admin_wallet_lp_reboot_remove(t.member_code));const s=await this._submit(e,this._ser_result(t));s&&setTimeout((t=>this.$router.push("/home/member_operate/reload_qualify")),600)}},async _submit(t,e){return await this.conn.patch(t,this.$store.state.token,e)},_ser_result(t){return{year:t.year,month:t.month,description:t.mark}}}},q=$,F=(0,g.Z)(q,s,r,!1,null,"2a59eadd",null),Z=F.exports}}]);
//# sourceMappingURL=6099.e94c8b60.js.map