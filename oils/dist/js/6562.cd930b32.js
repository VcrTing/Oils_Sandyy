"use strict";(self["webpackChunkoils"]=self["webpackChunkoils"]||[]).push([[6562],{1336:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div")},i=[],r={name:"",data(){return{}},methods:{async fecthingUser(t){let e=await this.conn.get(this.api.users,this.$store.state.token,{member_code:t});if(e)return e=e?e[0]:{},e}}},a=r,o=s(1001),l=(0,o.Z)(a,n,i,!1,null,"ed9069a8",null),u=l.exports},1452:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"alert alert-warning pa-3 px-7"},[e("span",[t._t("default")],2)])},i=[],r={name:"",data(){return{}}},a=r,o=s(1001),l=(0,o.Z)(a,n,i,!1,null,"8bc171c4",null),u=l.exports},1742:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div")},i=[],r={mounted(){this.$emit("sign_Father")}},a=r,o=s(1001),l=(0,o.Z)(a,n,i,!1,null,null,null),u=l.exports},7589:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div")},i=[],r={mounted(){},methods:{build_condition(t){const e={member_code:t.member_code};return e},async fetching(t){let e=null,s=this.build_condition(t);try{console.log("每个人的账户 cond =",s),e=await this.conn.ex_get(this,"fund_wallet",s)}catch(n){}return e=e&&e.data?e.data:null,e}}},a=r,o=s(1001),l=(0,o.Z)(a,n,i,!1,null,null,null),u=l.exports},6562:function(t,e,s){s.r(e),s.d(e,{default:function(){return E}});var n=function(){var t=this,e=t._self._c;return e("mc-form-page-layout",{attrs:{header:"轉賬",no_switch:!0},on:{back_Father:function(e){return t.$router.push("/home/loyalty/transfer_money")}}},[e("div",{staticClass:"py-3"},[e("div",{staticClass:"t-r pb-3"},[e("a",{staticClass:"a-sus",on:{click:function(e){return t.$router.push("/home/user/enroller")}}},[t._v("我的Enroller下線")]),e("a",[t._v("，")]),e("a",{staticClass:"a-sus",on:{click:function(e){return t.$router.push("/home/user/sponsor")}}},[t._v("我的Sponsor下線")])]),t.loading?e("qiong-loading"):e("f-tmp-form",{ref:"tmpREF",attrs:{hkd:t.me_hkd}})],1),e("div",{staticClass:"btn-transfer an_upper qiong-pt-15 qiong-txt-14"},[e("button",{staticClass:"reset",on:{click:t.reset}},[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-refresh")]),t._v(" 重置表單 ")],1),e("button",{staticClass:"btn-pri",on:{click:t.submit}},[e("v-icon",{staticClass:"qiong-txt-18 mr-3"},[t._v("mdi-cash-fast")]),t._v(" 確認轉賬 ")],1)]),e("net-fund",{ref:"fundREF"}),e("net-transfer",{ref:"tsREF"}),t.user?e("sign",{on:{sign_Father:t.LP}}):t._e()],1)},i=[],r=s(7116),a=s(1742),o=s(7589),l=s(8100),u=function(){var t=this,e=t._self._c;return e("form",{staticClass:"form-def form-transfer"},[e("v-row",[e("v-col",{attrs:{cols:"12",sm:5}},[e("label",[t._v("收款人編號")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.to_member_code,expression:"funnel.to_member_code"}],attrs:{type:"text",placeholder:"請輸入收款人的編號"},domProps:{value:t.funnel.to_member_code},on:{change:t.fetchingUser,input:function(e){e.target.composing||t.$set(t.funnel,"to_member_code",e.target.value)}}})]),e("v-col",{attrs:{cols:"12",sm:7}},[e("label",[t._v("收款人")]),e("div",{staticClass:"fx-l input input-fix fx-l"},[t.user_loading?e("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[t._v("mdi-loading")]):e("p",[t.user?e("span",[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-account-circle-outline")]),e("span",[t._v(" "+t._s(t.user.display_name)+" ")])],1):e("span",[t._v(" 無 ")])])],1)])],1),e("v-row",{staticClass:"transfer-wrapper"},[e("v-col",{attrs:{col:"12",sm:4,cols:"12"}},[e("label",{staticClass:"form-money"},[t._v("轉賬金額")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.quantity,expression:"funnel.quantity"}],staticClass:"input-transfer",attrs:{type:"number",placeholder:"請輸入正數"},domProps:{value:t.funnel.quantity},on:{input:function(e){e.target.composing||t.$set(t.funnel,"quantity",e.target.value)}}})]),e("v-col",{attrs:{col:"12",sm:8,cols:"12"}},[e("label",[t._v("我的積分總值")]),e("div",{staticClass:"input input-fix txt-money fw-b"},[t._v(" "+t._s(t.hkd)+"  HKD "),t.hkd<=1?e("span",{staticClass:"pl-1"},[t._v(" (您的可用余額過少) ")]):t._e()])])],1),e("widget-user-by-member-code",{ref:"userREF"}),t.msg?e("div",{staticClass:"pt-3 qiong-txt-16 anime-later"},[e("qiong-space",{attrs:{space:"0.5vw"}}),e("dialog-alert",[t._v(t._s(t.msg))])],1):t._e()],1)},c=[],d=s(1336),f=s(3186),h=s(6306),m=s(1452),p={components:{DateSelect:f.Z,WidgetUserByMemberCode:d.Z,DialogAlert:m.Z,QiongSpace:h.Z},props:{hkd:{type:Number,default:0}},data(){return{user:null,user_loading:!1,msg:"",funnel:{num:0,to_member_code:""},loading:!0}},mounted(){this.reset()},watch:{"funnel.num":function(t,e){t&&(t=Number.parseFloat(t),isNaN(t)&&t<0&&(this.funnel.quantity=0))}},methods:{geneTimed(t=24){let e=[];for(let s=0;s<t;s++)e.push(s);return e},reciveDate(t){const e=this.view.getToday();let s=this.view.judge_date(t,e);this.funnel.date=s?t:e,s||(this.loading=!0,setTimeout((t=>{this.loading=!1}),600))},validHour(){},validMark(){},validCode(){let t=this.funnel.to_member_code;return t=Number.parseInt(t),t=!!(t&&t>=203e3),t},validNum(){let t=this.funnel.quantity;return t=Number.parseInt(t),t=!(!t||0==t),t=!(t>this.hkd),t},async fetchingUser(){if(this.validCode()){this.user_loading=!0;let t=await this.$refs.userREF.fecthingUser(this.funnel.to_member_code);t&&this.setUser(t)}else this.setUser(null)},setUser(t){this.user_loading=!0,this.user=t,setTimeout((t=>this.user_loading=!1),400)},alert(t){this.msg=t,setTimeout((t=>this.msg=""),4400)},submit(){if(this.validCode()){if(this.validNum())return this.funnel;this.msg="檢測到 LP積分數字有誤，請檢查輸入。"}else this.msg="檢測到 用戶編號 為空或輸入有誤，請檢查輸入。";setTimeout((t=>this.msg=""),4400)},reset(){this.loading=!0,this.setUser(null),this.funnel={quantity:null,to_member_code:""},setTimeout((t=>{this.loading=!1}),400)}}},_=p,v=s(1001),g=(0,v.Z)(_,u,c,!1,null,"324ebf79",null),b=g.exports,x=function(){var t=this,e=t._self._c;return e("net-fund",{ref:"fdREF"})},C=[],y={components:{NetFund:o.Z},computed:{user(){return this.$store.state.user_backend}},methods:{async transfer(t){let e=await this.$refs.fdREF.fetching(this.user);if(e)try{console.log("data",t);let e=!0;if(console.log("转账 RES =",e),e)return 200}catch(s){return 500}return 400}}},k=y,w=(0,v.Z)(k,x,C,!1,null,null,null),F=w.exports,$={components:{NetTransfer:F,McFormPageLayout:l.Z,FTmpForm:b,NetFund:o.Z,Sign:a.Z,QiongLoading:r.Z},name:"",data(){return{me_hkd:0,loading:!0,doing:!1}},computed:{user(){let t=this.$store.state.user_backend;return t||null}},methods:{reset(){this.$refs.tmpREF.reset()},unLock(){this.doing=!1},async submit(){if(this.doing)return;this.doing=!0;let t=this.$refs.tmpREF.submit();t&&(t=await this.$refs.tsREF.transfer(t),500==t?(this.$refs.tmpREF.alert("服务器错误，转账失败！！！"),this.unLock()):400==t?(this.$refs.tmpREF.alert("网络错误，未生成转账任务！！！"),this.unLock()):setTimeout((t=>{this.unLock(),this.$router.push("/home/loyalty/transfer_money")}),800))},async LP(){let t=await this.$refs.fundREF.fetching(this.user);t&&t.length>0&&(this.me_hkd=t[0].wallet),setTimeout((()=>{this.loading=!1}),600)}}},Z=$,q=(0,v.Z)(Z,n,i,!1,null,"168ef3fb",null),E=q.exports},8100:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"px-0",attrs:{fluid:""}},[e("div",{staticClass:"fx-l py-3 pl-5 txt-header"},[e("div",{staticClass:"d-ib hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",{staticClass:"qiong-txt-22"},[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"pl-2 fw-b hand",on:{click:function(e){return t.$emit("back_Father")}}},[t._v(" "+t._s(t.header)+" ")])]),e("div",{staticClass:"panel-pure txt-def"},[t.no_switch?t._e():e("div",{staticClass:"fx-s"},[e("div"),e("div",{staticClass:"qiong-txt-10 changer"},t._l(t.tabs,(function(s,n){return e("button",{key:n,staticClass:"ml-5 hand",class:{"btn-pri-thin py-2 px-6 fw-b":t.now==s.path,"txt-pri":t.now!=s.path},on:{click:function(e){return t.$router.push(s.path)}}},[t._v(" "+t._s(s.txt)+" ")])})),0)]),e("div",{staticClass:"qiong-txt-12 upper"},[t._t("default")],2)]),e("div",{staticClass:"pti-go-top hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"mobie-for-form"})])},i=[],r={name:"",props:["header","no_switch"],data(){return{}},computed:{now(){let t=this.$route.path;return t=t?t.split("/"):null,t=t?t[t.length-1]:null,t},tabs(){return[{txt:"增加 LP 積分",path:"form_lp_plus"},{txt:"更改會員 LP 等級",path:"form_level_change"},{txt:"重啟會員 LP 資格",path:"form_reload_qualify"}]}}},a=r,o=s(1001),l=(0,o.Z)(a,n,i,!1,null,"7b50eaad",null),u=l.exports}}]);
//# sourceMappingURL=6562.cd930b32.js.map