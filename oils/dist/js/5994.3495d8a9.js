"use strict";(self["webpackChunkoils"]=self["webpackChunkoils"]||[]).push([[5994],{1336:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div")},a=[],i={name:"",data(){return{}},methods:{async fecthingUser(t){let e=await this.conn.get(this.api.users,this.$store.state.token,{member_code:t});if(e)return e=e?e[0]:{},e}}},r=i,l=s(1001),o=(0,l.Z)(r,n,a,!1,null,"ed9069a8",null),u=o.exports},1452:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"alert alert-warning pa-3 px-7"},[e("span",[t._t("default")],2)])},a=[],i={name:"",data(){return{}}},r=i,l=s(1001),o=(0,l.Z)(r,n,a,!1,null,"8bc171c4",null),u=o.exports},8100:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"px-0",attrs:{fluid:""}},[e("div",{staticClass:"fx-l py-3 pl-5 txt-header"},[e("div",{staticClass:"d-ib hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",{staticClass:"qiong-txt-22"},[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"pl-2 fw-b hand",on:{click:function(e){return t.$emit("back_Father")}}},[t._v(" "+t._s(t.header)+" ")])]),e("div",{staticClass:"panel-pure txt-def"},[t.no_switch?t._e():e("div",{staticClass:"fx-s"},[e("div"),e("div",{staticClass:"qiong-txt-10 changer"},t._l(t.tabs,(function(s,n){return e("button",{key:n,staticClass:"ml-5 hand",class:{"btn-pri-thin py-2 px-6 fw-b":t.now==s.path,"txt-pri":t.now!=s.path},on:{click:function(e){return t.$router.push(s.path)}}},[t._v(" "+t._s(s.txt)+" ")])})),0)]),e("div",{staticClass:"qiong-txt-12 upper"},[t._t("default")],2)]),e("div",{staticClass:"pti-go-top hand",on:{click:function(e){return t.$emit("back_Father")}}},[e("v-icon",[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"mobie-for-form"})])},a=[],i={name:"",props:["header","no_switch"],data(){return{}},computed:{now(){let t=this.$route.path;return t=t?t.split("/"):null,t=t?t[t.length-1]:null,t},tabs(){return[{txt:"增加 LP 積分",path:"form_lp_plus"},{txt:"更改會員 LP 等級",path:"form_level_change"},{txt:"重啟會員 LP 資格",path:"form_reload_qualify"}]}}},r=i,l=s(1001),o=(0,l.Z)(r,n,a,!1,null,"7b50eaad",null),u=o.exports},5994:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var n=function(){var t=this,e=t._self._c;return e("mc-form-page-layout",{attrs:{header:"增加會員 LP 積分"},on:{back_Father:function(e){return t.$router.push("/home/member_operate/lp_plus")}}},[e("div",[e("f-mlp-form",{ref:"formREF"})],1),e("div",{staticClass:"btn-transfer an_upper qiong-pt-15 qiong-txt-14"},[e("button",{staticClass:"reset",on:{click:t.reset}},[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-refresh")]),t._v(" 重置表單 ")],1),e("button",{staticClass:"btn-pri",on:{click:t.submit}},[e("v-icon",{staticClass:"qiong-txt-16 mr-3"},[t._v("mdi-check-underline")]),t._v(" 提交結果 ")],1)])])},a=[],i=s(8100),r=function(){var t=this,e=t._self._c;return e("form",{staticClass:"form-def"},[e("v-row",[e("v-col",{attrs:{cols:"12",sm:5}},[e("label",[t._v("用戶編號")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.member_code,expression:"funnel.member_code"}],attrs:{type:"text",placeholder:"請輸入用戶的編號"},domProps:{value:t.funnel.member_code},on:{change:t.fetchingUser,input:function(e){e.target.composing||t.$set(t.funnel,"member_code",e.target.value)}}})]),e("v-col",{attrs:{cols:"12",sm:7}},[e("label",[t._v("用戶名稱")]),e("div",{staticClass:"fx-l input input-fix fx-l"},[t.user_loading?e("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[t._v("mdi-loading")]):e("p",[t.user?e("span",[e("v-icon",{staticClass:"qiong-txt-16"},[t._v("mdi-account-circle-outline")]),e("span",[t._v(t._s(t.user.display_name))])],1):e("span",[t._v("(自動檢索)")])])],1)])],1),e("v-row",[e("v-col",{attrs:{cols:"12",sm:4}},[e("label",{staticClass:"txt-pri"},[t._v("更改LP積分")]),e("nav",{staticClass:"input-with-icon input-with-select"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.funnel.is_add,expression:"funnel.is_add"}],staticClass:"input-air i",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.funnel,"is_add",e.target.multiple?s:s[0])}}},[e("option",{domProps:{value:!0}},[t._v("+  增加")]),e("option",{domProps:{value:!1}},[t._v("-  減去")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.num,expression:"funnel.num"}],attrs:{type:"number",placeholder:"請輸入正數"},domProps:{value:t.funnel.num},on:{change:t.floatRES,input:function(e){e.target.composing||t.$set(t.funnel,"num",e.target.value)}}}),e("span",[t._v(" LP ")])])]),e("v-col",{attrs:{cols:"12",sm:8}},[e("label",[t._v("積分結果")]),e("div",{staticClass:"input input-fix"},[t.user_loading?e("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[t._v("mdi-loading")]):e("div",[t.user&&t.user.lp_wallet?e("p",{staticClass:"txt-money"},[t._v(" "+t._s(t.user.lp_wallet.LP_available)+"  LP "),e("span",{staticClass:"txt-sus pl-1"},[t._v(t._s(t.funnel.is_add?"+":"-"))]),t._v("   "+t._s(this.funnel.num?this.funnel.num:0)+" "),e("span",{staticClass:"txt-sus pl-1"},[t._v("=")]),t._v("   "+t._s(t.num_res)+"  LP ")]):e("span",[t._v("(自動計算) ")])])],1)])],1),e("v-row",[e("v-col",{staticClass:"input-time",attrs:{col:"8",sm:4}},[e("label",[t._v("入賬日期")]),t.loading?e("div",{staticClass:"input fx-c w-100"},[e("v-icon",{staticClass:"qiong-txt-18 ani-rotate_s loading"},[t._v("mdi-loading")])],1):e("date-select",{attrs:{date:t.funnel.date},on:{timed_Father:t.reciveDate}})],1)],1),e("v-row",[e("v-col",{attrs:{col:"12"}},[e("label",[t._v("備註")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.funnel.mark,expression:"funnel.mark"}],staticClass:"input-bg",attrs:{type:"text",placeholder:"輸入您要備註的文字"},domProps:{value:t.funnel.mark},on:{change:t.validMark,input:function(e){e.target.composing||t.$set(t.funnel,"mark",e.target.value)}}})])],1),e("widget-user-by-member-code",{ref:"userREF"}),t.msg?e("div",{staticClass:"pt-3 qiong-txt-16 anime-later"},[e("qiong-space",{attrs:{space:"0.5vw"}}),e("dialog-alert",[t._v(t._s(t.msg))])],1):t._e()],1)},l=[],o=s(1336),u=s(3186),c=s(6306),d=s(1452),m={components:{DateSelect:u.Z,WidgetUserByMemberCode:o.Z,DialogAlert:d.Z,QiongSpace:c.Z},computed:{num_res(){if(this.user&&this.user.lp_wallet){let t=this.user.lp_wallet.LP_available,e=this.funnel.is_add?this.view.floatAdd(t,this.funnel.num):this.view.floatSub(t,this.funnel.num);return e<=0&&(this.funnel.num=t,e=0),e}return 0}},data(){return{user:null,user_loading:!1,msg:"",funnel:{date:"",mark:"",is_add:!0,num:10,hour:0,minuts:0,member_code:"",changer:"ssss@123.com"},loading:!0}},mounted(){this.reset()},methods:{geneTimed(t=24){let e=[];for(let s=0;s<t;s++)e.push(s);return e},reciveDate(t){const e=this.view.getToday();let s=this.view.judge_date(t,e);this.funnel.date=s?t:e,s||(this.loading=!0,setTimeout((t=>{this.loading=!1}),600))},validHour(){},validMark(){},validCode(){let t=this.funnel.member_code;return t=Number.parseInt(t),t=!!(t&&t>=203e3),t},floatRES(){let t=this.funnel.num;t&&(this.funnel.num=Number.parseFloat(t).toFixed(2))},validNum(){let t=this.funnel.num;return t=Number.parseFloat(t),!(!t||0==t)},async fetchingUser(){if(this.validCode()){this.user_loading=!0;let t=await this.$refs.userREF.fecthingUser(this.funnel.member_code);t&&this.setUser(t)}else this.setUser(null)},setUser(t){this.user_loading=!0,this.user=t,setTimeout((t=>this.user_loading=!1),400)},submit(){if(this.validCode()){if(this.validNum())return this.funnel;this.msg="檢測到 LP積分數字 為空，請檢查輸入。"}else this.msg="檢測到 用戶編號 為空或輸入有誤，請檢查輸入。";setTimeout((t=>this.msg=""),4400)},reset(){this.loading=!0,this.setUser(null),this.funnel={date:this.view.getToday(),mark:"",num:null,hour:23,minuts:59,is_add:!0,member_code:"",changer:"ssss@123.com"},setTimeout((t=>{this.loading=!1}),400)}}},p=m,v=s(1001),f=(0,v.Z)(p,r,l,!1,null,null,null),h=f.exports,_={components:{McFormPageLayout:i.Z,FMlpForm:h},name:"",data(){return{}},computed:{user(){return this.$store.state.user_backend}},methods:{reset(){this.$refs.formREF.reset()},async submit(){let t=this.$refs.formREF.submit();if(t){t.member_code;t=this._params(t);const e=await this.conn.post(this.api.admin_wallet_lp_add(t.member_code),this.$store.state.token,t);e&&setTimeout((t=>this.$router.push("/home/member_operate/lp_plus")),600)}},_params(t){return{date:t.date,LP_change:(t.is_add?"":"-")+t.num,remark:t.mark,member_code:t.member_code}}}},g=_,b=(0,v.Z)(g,n,a,!1,null,"fe7603f6",null),x=b.exports}}]);
//# sourceMappingURL=5994.3495d8a9.js.map