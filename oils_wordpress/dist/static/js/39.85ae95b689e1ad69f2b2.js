webpackJsonp([39],{gEh4:function(e,t){},nifv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("Xxa5"),a=n.n(s),i=n("exGp"),r=n.n(i),o=n("akmo"),u=n("5dBV"),l=n.n(u),c=n("gBtx"),m=n.n(c),d=n("Gi8X"),v=n("YPBt"),f=n("Um5R"),_=n("Vv01"),p={components:{DateSelect:v.a,WidgetUserByMemberCode:d.a,DialogAlert:_.a,QiongSpace:f.a},computed:{num_res:function(){if(this.user&&this.user.lp_wallet){var e=this.user.lp_wallet.LP_available,t=this.funnel.is_add?this.view.floatAdd(e,this.funnel.num):this.view.floatSub(e,this.funnel.num);return t<=0&&(this.funnel.num=e,t=0),t}return 0}},data:function(){return{user:null,user_loading:!1,msg:"",funnel:{date:"",mark:"",is_add:!0,num:10,hour:0,minuts:0,member_code:"",changer:"ssss@123.com"},loading:!0}},mounted:function(){this.reset()},methods:{geneTimed:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t=[],n=0;n<e;n++)t.push(n);return t},reciveDate:function(e){var t=this,n=this.view.getToday(),s=this.view.judge_date(e,n);this.funnel.date=s?e:n,s||(this.loading=!0,setTimeout(function(e){t.loading=!1},600))},validHour:function(){},validMark:function(){},validCode:function(){var e=this.funnel.member_code;return e=!!((e=m()(e))&&e>=203e3)},floatRES:function(){var e=this.funnel.num;e&&(this.funnel.num=l()(e).toFixed(2))},validNum:function(){var e=this.funnel.num;return!(!(e=l()(e))||0==e)},fetchingUser:function(){var e=this;return r()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.validCode()){t.next=8;break}return e.user_loading=!0,t.next=4,e.$refs.userREF.fecthingUser(e.funnel.member_code);case 4:(n=t.sent)&&e.setUser(n),t.next=9;break;case 8:e.setUser(null);case 9:case"end":return t.stop()}},t,e)}))()},setUser:function(e){var t=this;this.user_loading=!0,this.user=e,setTimeout(function(e){return t.user_loading=!1},400)},submit:function(){var e=this;if(this.validCode()){if(this.validNum())return this.funnel;this.msg="檢測到 LP積分數字 為空，請檢查輸入。"}else this.msg="檢測到 用戶編號 為空或輸入有誤，請檢查輸入。";setTimeout(function(t){return e.msg=""},4400)},reset:function(){var e=this;this.loading=!0,this.setUser(null),this.funnel={date:this.view.getToday(),mark:"",num:null,hour:23,minuts:59,is_add:!0,member_code:"",changer:"ssss@123.com"},setTimeout(function(t){e.loading=!1},400)}}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"form-def"},[n("v-row",[n("v-col",{attrs:{cols:"12",sm:5}},[n("label",[e._v("用戶編號")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.funnel.member_code,expression:"funnel.member_code"}],attrs:{type:"text",placeholder:"請輸入用戶的編號"},domProps:{value:e.funnel.member_code},on:{change:e.fetchingUser,input:function(t){t.target.composing||e.$set(e.funnel,"member_code",t.target.value)}}})]),e._v(" "),n("v-col",{attrs:{cols:"12",sm:7}},[n("label",[e._v("用戶名稱")]),e._v(" "),n("div",{staticClass:"fx-l input input-fix fx-l"},[e.user_loading?n("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[e._v("mdi-loading")]):n("p",[e.user?n("span",[n("v-icon",{staticClass:"qiong-txt-16"},[e._v("mdi-account-circle-outline")]),e._v(" "),n("span",[e._v(e._s(e.user.display_name))])],1):n("span",[e._v("(自動檢索)")])])],1)])],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12",sm:4}},[n("label",{staticClass:"txt-pri"},[e._v("更改LP積分")]),e._v(" "),n("nav",{staticClass:"input-with-icon input-with-select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.funnel.is_add,expression:"funnel.is_add"}],staticClass:"input-air i",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.funnel,"is_add",t.target.multiple?n:n[0])}}},[n("option",{domProps:{value:!0}},[e._v("+  增加")]),e._v(" "),n("option",{domProps:{value:!1}},[e._v("-  減去")])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.funnel.num,expression:"funnel.num"}],attrs:{type:"number",placeholder:"請輸入正數"},domProps:{value:e.funnel.num},on:{change:e.floatRES,input:function(t){t.target.composing||e.$set(e.funnel,"num",t.target.value)}}}),e._v(" "),n("span",[e._v("\n                    LP\n                ")])])]),e._v(" "),n("v-col",{attrs:{cols:"12",sm:8}},[n("label",[e._v("積分結果")]),e._v(" "),n("div",{staticClass:"input input-fix"},[e.user_loading?n("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[e._v("mdi-loading")]):n("div",[e.user&&e.user.lp_wallet?n("p",{staticClass:"txt-money"},[e._v("\n                        "+e._s(e.user.lp_wallet.LP_available)+"  LP\n                        "),n("span",{staticClass:"txt-sus pl-1"},[e._v(e._s(e.funnel.is_add?"+":"-"))]),e._v("\n                          "+e._s(this.funnel.num?this.funnel.num:0)+"\n                        "),n("span",{staticClass:"txt-sus pl-1"},[e._v("=")]),e._v("\n                          "+e._s(e.num_res)+"  LP\n                    ")]):n("span",[e._v("(自動計算) ")])])],1)])],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"input-time",attrs:{col:"8",sm:4}},[n("label",[e._v("入賬日期")]),e._v(" "),e.loading?n("div",{staticClass:"input fx-c w-100"},[n("v-icon",{staticClass:"qiong-txt-18 ani-rotate_s loading"},[e._v("mdi-loading")])],1):n("date-select",{attrs:{date:e.funnel.date},on:{timed_Father:e.reciveDate}})],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{col:"12"}},[n("label",[e._v("備註")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.funnel.mark,expression:"funnel.mark"}],staticClass:"input-bg",attrs:{type:"text",placeholder:"輸入您要備註的文字"},domProps:{value:e.funnel.mark},on:{change:e.validMark,input:function(t){t.target.composing||e.$set(e.funnel,"mark",t.target.value)}}})])],1),e._v(" "),n("widget-user-by-member-code",{ref:"userREF"}),e._v(" "),e.msg?n("div",{staticClass:"pt-3 qiong-txt-16 anime-later"},[n("qiong-space",{attrs:{space:"0.5vw"}}),e._v(" "),n("dialog-alert",[e._v(e._s(e.msg))])],1):e._e()],1)},staticRenderFns:[]},g=n("VU/8")(p,h,!1,null,null,null).exports,b={components:{McFormPageLayout:o.a,FMlpForm:g},name:"",data:function(){return{}},computed:{user:function(){return this.$store.state.user_backend}},methods:{reset:function(){this.$refs.formREF.reset()},submit:function(){var e=this;return r()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.$refs.formREF.submit())){t.next=8;break}return n.member_code,n=e._params(n),t.next=6,e.conn.post(e.api.admin_wallet_lp_add(n.member_code),e.$store.state.token,n);case 6:t.sent&&setTimeout(function(t){return e.$router.push("/home/member_operate/lp_plus")},600);case 8:case"end":return t.stop()}},t,e)}))()},_params:function(e){return{date:e.date,LP_change:(e.is_add?"":"-")+e.num,remark:e.mark,member_code:e.member_code}}}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("mc-form-page-layout",{attrs:{header:"增加會員 LP 積分"},on:{back_Father:function(t){return e.$router.push("/home/member_operate/lp_plus")}}},[n("div",[n("f-mlp-form",{ref:"formREF"})],1),e._v(" "),n("div",{staticClass:"btn-transfer an_upper qiong-pt-15 qiong-txt-14"},[n("button",{staticClass:"reset",on:{click:e.reset}},[n("v-icon",{staticClass:"qiong-txt-16"},[e._v("mdi-refresh")]),e._v("\n                重置表單\n            ")],1),e._v(" "),n("button",{staticClass:"btn-pri",on:{click:e.submit}},[n("v-icon",{staticClass:"qiong-txt-16 mr-3"},[e._v("mdi-check-underline")]),e._v("\n                提交結果\n            ")],1)])])},staticRenderFns:[]};var w=n("VU/8")(b,x,!1,function(e){n("gEh4")},"data-v-fe7603f6",null);t.default=w.exports}});
//# sourceMappingURL=39.85ae95b689e1ad69f2b2.js.map