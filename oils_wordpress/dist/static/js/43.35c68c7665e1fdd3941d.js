webpackJsonp([43],{HUbM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),o=n.n(r),s=n("exGp"),a=n.n(s),i=n("akmo"),u=n("gBtx"),l=n.n(u),c=n("Gi8X"),m=n("YPBt"),v=n("Um5R"),f=n("Vv01"),d=n("PJh5"),_=n.n(d),p={methods:{lunching:function(){var e=this;return a()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.conn.get(e.api.chronus,e.$store.state.token,{_limit:999});case 2:return n=t.sent,t.abrupt("return",n?n.map(function(t){return e.ser_res(t)}):[]);case 4:case"end":return t.stop()}},t,e)}))()},ser_res:function(e){return delete e.orders,delete e.bonuses,delete e.bonus_calculations,e.now=_()(e.end).format("yyyy-MM-DD"),e.now_list=e.now.split("-"),e}}},h={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]},g=n("VU/8")(p,h,!1,null,null,null).exports,b={components:{DateSelect:m.a,WidgetUserByMemberCode:c.a,DialogAlert:f.a,QiongSpace:v.a,NetChronus:g},computed:{mons:function(){var e=this,t=[],n=this.chronus;return n&&n.map(function(n){n.now_list[0]==e.funnel.year&&t.push({chronu_id:n.id,v:l()(n.now_list[1])})}),t},bonus_now:function(){var e=this,t=null,n=this.user;return n&&this.chronu_now&&(n=n.bonuses?n.bonuses:[]).map(function(n){n.time_period==e.chronu_now.id&&(t=n)}),t}},data:function(){return{user:null,user_loading:!1,msg:"",now_y:"",chronus:[],chronu_now:null,funnel:{date:"",mark:"",is_reboot:!0,year:0,month:1,member_code:""},loading:!0}},mounted:function(){var e=this;return a()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.now_y=(new Date).getFullYear(),e.funnel.year=e.now_y,e.reset(),t.next=5,e.$refs.chroREF.lunching();case 5:e.chronus=t.sent;case 6:case"end":return t.stop()}},t,e)}))()},methods:{geneYear:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2021,t=this.now_y,n=[e],r=0;r<=t-e;r++)n.push(e+=1);return n},getNowChronu:function(){var e=this,t=this.funnel.month,n=this.chronus;n&&n.map(function(n){t==l()(n.now_list[1])&&(e.chronu_now=n)})},reciveDate:function(e){var t=this,n=this.view.getToday(),r=this.view.judge_date(e,n);this.funnel.date=r?e:n,r||(this.loading=!0,setTimeout(function(e){t.loading=!1},600))},validMark:function(){},validMonth:function(){var e=this.funnel.month;return!!(e&&e>0)},validCode:function(){var e=this.funnel.member_code;return e=!!((e=l()(e))&&e>=203e3)},validNum:function(){var e=this.funnel.num;return e=!(!(e=l()(e))||0==e)},fetchingUser:function(){var e=this;return a()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.validCode()){t.next=8;break}return e.user_loading=!0,t.next=4,e.$refs.userREF.fecthingUser(e.funnel.member_code);case 4:(n=t.sent)&&e.setUser(n),t.next=9;break;case 8:e.setUser(null);case 9:case"end":return t.stop()}},t,e)}))()},setUser:function(e){var t=this;this.user_loading=!0,this.user=e,setTimeout(function(e){return t.user_loading=!1},400)},submit:function(){var e=this;if(this.validCode()){if(this.validMonth())return this.funnel;this.msg="檢測到您未選擇 月份。"}else this.msg="檢測到 用戶編號 為空或輸入有誤，請檢查輸入。";setTimeout(function(t){return e.msg=""},4400)},reset:function(){var e=this;new Date;this.loading=!0,this.setUser(null),this.funnel={date:this.view.getToday(),mark:"",member_code:"",is_reboot:!0,year:this.now_y,month:this.mons?this.mons[0]:-1},setTimeout(function(t){e.loading=!1},400)}}},w={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"form-def"},[n("v-row",[n("v-col",{attrs:{col:"12",sm:5}},[n("label",[e._v("用戶編號")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.funnel.member_code,expression:"funnel.member_code"}],attrs:{type:"text",placeholder:"請輸入用戶的編號"},domProps:{value:e.funnel.member_code},on:{change:e.fetchingUser,input:function(t){t.target.composing||e.$set(e.funnel,"member_code",t.target.value)}}})]),e._v(" "),n("v-col",{attrs:{cols:"12",sm:7}},[n("label",[e._v("用戶名稱")]),e._v(" "),n("div",{staticClass:"fx-l input input-fix fx-l"},[e.user_loading?n("v-icon",{staticClass:"qiong-txt-18 ani-rotate loading"},[e._v("mdi-loading")]):n("p",[e.user?n("span",[n("v-icon",{staticClass:"qiong-txt-16"},[e._v("mdi-account-circle-outline")]),e._v(" "),n("span",[e._v(e._s(e.user.display_name))])],1):n("span",[e._v("(自動檢索)")])])],1)])],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"8",sm:12}},[n("label",{staticClass:"sub"},[e._v("選擇月份")]),e._v(" "),n("nav",{staticClass:"input-timed_tool"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.funnel.year,expression:"funnel.year"}],staticClass:"input",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.funnel,"year",t.target.multiple?n:n[0])}}},e._l(e.geneYear(),function(t,r){return n("option",{key:r,domProps:{value:t}},[e._v(e._s(t)+"  年")])}),0),e._v(" "),n("span",{staticClass:"mx-2 fw-b"}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.funnel.month,expression:"funnel.month"}],staticClass:"input",on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.funnel,"month",t.target.multiple?n:n[0])},function(t){return e.getNowChronu()}]}},e._l(e.mons,function(t,r){return n("option",{key:r,domProps:{value:t.v}},[e._v(e._s(t.v)+"  月份")])}),0),e._v(" "),n("span",{staticClass:"mx-2 fw-b"})])])],1),e._v(" "),n("v-row",[n("v-col",{attrs:{col:"12",sm:4}},[n("label",{staticClass:"txt-pri"},[e._v("重啟會員等級")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.funnel.is_reboot,expression:"funnel.is_reboot"}],class:{"option-succ":e.funnel.is_reboot,"option-err":!e.funnel.is_reboot},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.funnel,"is_reboot",t.target.multiple?n:n[0])}}},[n("option",{domProps:{value:!0}},[e._v("重啟")]),e._v(" "),n("option",{domProps:{value:!1}},[e._v("移除")])])])],1),e._v(" "),n("v-row",[n("v-col",{attrs:{col:"12"}},[n("label",[e._v("備註")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.funnel.mark,expression:"funnel.mark"}],staticClass:"input-bg",attrs:{type:"text",placeholder:"輸入您要備註的文字"},domProps:{value:e.funnel.mark},on:{change:e.validMark,input:function(t){t.target.composing||e.$set(e.funnel,"mark",t.target.value)}}})])],1),e._v(" "),n("widget-user-by-member-code",{ref:"userREF"}),e._v(" "),n("net-chronus",{ref:"chroREF"}),e._v(" "),e.msg?n("div",{staticClass:"pt-3 qiong-txt-16 anime-later"},[n("qiong-space",{attrs:{space:"0.5vw"}}),e._v(" "),n("dialog-alert",[e._v(e._s(e.msg))])],1):e._e()],1)},staticRenderFns:[]},x=n("VU/8")(b,w,!1,null,null,null).exports,y={components:{McFormPageLayout:i.a,FMrqForm:x},name:"",data:function(){return{}},methods:{reset:function(){this.$refs.formREF.reset()},submit:function(){var e=this;return a()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.$refs.formREF.submit())){t.next=9;break}return r=e.api.admin_wallet_lp_reboot(n.member_code),!n.is_reboot&&(r=e.api.admin_wallet_lp_reboot_remove(n.member_code)),t.next=7,e._submit(r,e._ser_result(n));case 7:t.sent&&setTimeout(function(t){return e.$router.push("/home/member_operate/reload_qualify")},600);case 9:case"end":return t.stop()}},t,e)}))()},_submit:function(e,t){var n=this;return a()(o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.conn.patch(e,n.$store.state.token,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,n)}))()},_ser_result:function(e){return{year:e.year,month:e.month,description:e.mark}}}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("mc-form-page-layout",{attrs:{header:"重啟會員 LP 等級"},on:{back_Father:function(t){return e.$router.push("/home/member_operate/reload_qualify")}}},[n("div",[n("f-mrq-form",{ref:"formREF"})],1),e._v(" "),n("div",{staticClass:"fx-c my-3 qiong-pt-15 qiong-txt-14"},[n("button",{staticClass:"btn-pri mx-3 px-5 py-1 round an_lefter",on:{click:e.submit}},[n("v-icon",{staticClass:"qiong-txt-16 mr-2"},[e._v("mdi-check-underline")]),e._v("\n                提交結果\n            ")],1),e._v(" "),n("button",{staticClass:"mx-3 px-5 py-1 reset round",on:{click:e.reset}},[n("v-icon",{staticClass:"qiong-txt-16"},[e._v("mdi-refresh")]),e._v("\n                重置表單\n            ")],1)])])},staticRenderFns:[]};var C=n("VU/8")(y,k,!1,function(e){n("Pjb+")},"data-v-3551d984",null);t.default=C.exports},"Pjb+":function(e,t){}});
//# sourceMappingURL=43.35c68c7665e1fdd3941d.js.map